target C;

main reactor {

    state foo:int(2);

    method getFoo(): int {=
        return self->foo;
    =}

    method add(x:int) {=
        self->foo += x;
    =}

    reaction(startup){=
        lf_print("Foo is initialized to %d", self->getFoo(self));
        if (self->getFoo(self) != 2) {
            lf_print_error_and_exit("Expected 2!");
        }

        self->add(self, 40);
        int a = self->getFoo(self);
        lf_print("2 + 40 = %d", a);
        if (a != 42) {
            lf_print_error_and_exit("Expected 42!");
        }
    =}
}
